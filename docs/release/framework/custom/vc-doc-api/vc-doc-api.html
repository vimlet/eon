<style>
    vc-doc-api {
        height: 100%;
    }

    @font-face {
        font-family: 'Roboto';
        font-style: normal;
        font-weight: 400;
        src: url('fonts/Roboto/Roboto-Regular.ttf');
    }

    html,
    body {
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif !important;
        background-color: #fff !important;
        overflow: hidden;
        color: #6b6b6b !important;
    }

    #vc-doc-api-header {
        margin-bottom: 20px;
    }

    #vc-doc-api-apiMain {
        height: 100%;
    }

    #vc-doc-api-apiMenu {
        padding-left: 0px;
        height: 50px;
        min-height: 50px;
        /* background-color: #2b2b2b;
        background-image: url("img/menu/menu.png"); */
        background-color: transparent;
        z-index: 10;
    }

    .vc-doc-colorBand {
        width: 100%;
        height: 5px;
        background-color: #6b6b6b;
    }

    .vc-layout-columnContainer {
        display: flex;
        flex-direction: column;
    }


    vc-menu {
        background-color: transparent !important;
        height: 100%;
        width: 100%;
    }

    vc-menu[layout="horizontal"] vc-item {
        line-height: 50px;
        min-width: 100px;
        flex-grow: 0 !important;
        color: #e6e6e6 !important;
    }

    #menuFunctionsContainer,
    #menuPropertiesContainer {
        max-height: 300px;
        display: flex;
        flex-direction: column;
    }

    vc-searchbar .main {
        border: none !important;
        padding: 0px !important;
    }

    .vc-doc-api-menuSearchBar .field {
        background-color: transparent !important;
    }

    .vc-doc-api-menuSearchBar .field input {
        height: 50px;
        outline: none;
        background: transparent;
        border: none;
        color: #c1c1c1;
        padding: 0 10px;
    }

    vc-doc-api .vc-bg4,
    .vc-bg3 {
        background: transparent !important;
    }

    vc-doc-api .vc-menu-dropdown {
        background-color: #3a3a3a !important;
    }

    vc-doc-api .dropdownTrigger {
        background-color: transparent !important;
    }

    .vc-doc-api-menuDropdown .vc-menu-dropdown {
        min-width: 200px;
        z-index: 1000 !important;
    }

    .vc-doc-api-menuDropdown .dropdown vc-item {
        min-width: 200px;
    }

    #vc-doc-api-content {
        overflow-y: auto;
        box-sizing: border-box;
        padding-right: 21px;
        padding-left: 25px;
        margin-bottom: 300px;
        padding-top: 20px;
        height: calc(100% - 55px);
        min-width: 400px;
    }

    .vc-doc-api-t1 {
        font-size: 50px;
        font-weight: bold;
        margin-top: 65px !important;
        margin-bottom: 35px !important;
    }

    .vc-doc-api-t2 {
        font-size: 1.5em;
    }

    .vc-doc-api-t3 {
        font-size: 1.25em;
    }

    .vc-doc-api-block {
        margin-bottom: 20px;
    }

    .vc-doc-api-functionDetail {
        margin-top: 20px;
    }

    .vc-doc-api-functionDetail vc-doc-table {
        margin-bottom: 20px;
    }

    .vc-doc-api-functionDetail vc-table {
        margin: 10px 0px;
    }

    .vc-doc-api-textColorType {
        color: #ad7a02;
    }

    .vc-doc-api-textColorFunction {
        margin: 5px 0px;
        color: #383838;
    }

    .vc-doc-api-textColorName {
        color: #3c509c;
    }

    .vc-doc-api-hidePrivate {
        display: none !important;
    }

    .vc-doc-api-searchHide {
        display: none !important;
    }

    .vc-doc-api-menuSearchItem {
        align-items: flex-start !important;
        justify-content: flex-end !important;
        padding-left: 10px !important;
        box-sizing: border-box;
    }

    #vc-doc-api-togglePrivate {
        margin-left: auto;
    }

    .vc-doc-api-noExist {
        display: none;
    }


    #vc-doc-api-goToTop {
        display: block;
        bottom: -100px;
        position: fixed;
        right: 30px;
        z-index: 99;
        border: none;
        outline: none;
        background-color: #333333;
        color: white;
        cursor: pointer;
        padding: 10px;
        border-radius: 50%;
        -webkit-box-shadow: 1px 1px 5px 0px rgba(0, 0, 0, 0.75);
        -moz-box-shadow: 1px 1px 5px 0px rgba(0, 0, 0, 0.75);
        box-shadow: 1px 1px 5px 0px rgba(0, 0, 0, 0.75);
    }

    .vc-doc-api-showGoToTop {
        -webkit-animation: vc-doc-api-showGoToTopAnim 0.7s forwards;
        /* for less modern browsers */
        animation: vc-doc-api-showGoToTopAnim 0.7s forwards;
    }

    .vc-doc-api-hideGoToTop {
        -webkit-animation: vc-doc-api-hideGoToTopAnim 0.5s forwards;
        /* for less modern browsers */
        animation: vc-doc-api-hideGoToTopAnim 0.5s forwards;
    }

    vc-doc-api .vc-searchbar-searchButton {
        margin-left: 0px !important;
        padding: 0px !important;
    }

    vc-doc-api vc-searchbar .vc-bg2-boxshadow {
        -webkit-box-shadow: 0 2px 8px -2px #000000;
        -moz-box-shadow: 0 2px 8px -2px #000000;
        box-shadow: 0 2px 8px -2px #000000;
    }

    /* Safari 4.0 - 8.0 */

    @-webkit-keyframes vc-doc-api-showGoToTopAnim {
        from {
            bottom: -100px;
        }
        to {
            bottom: 10px;
        }
    }

    @keyframes vc-doc-api-showGoToTopAnim {
        from {
            bottom: -100px;
        }
        to {
            bottom: 10px;
        }
    }

    /* Safari 4.0 - 8.0 */

    @-webkit-keyframes vc-doc-api-hideGoToTopAnim {
        from {
            bottom: 10px;
        }
        to {
            bottom: -100px;
        }
    }

    @keyframes vc-doc-api-hideGoToTopAnim {
        from {
            bottom: 10px;
        }
        to {
            bottom: -100px;
        }
    }


    @media only screen and (max-width: 700px) {
        #vc-doc-api-apiMenu {
            padding-left: 50px;
        }
    }
</style>

<template>
    <vc-layout type="column" id="vc-doc-api-apiMain">
        <vc-layout id="vc-doc-api-apiMenu">

            <vc-menu layout="horizontal" separators="false" background="true" direction="bottom-right">
                <vc-item type="dropdown" name="Properties" class="vc-doc-api-menuDropdown" onclick="this.querySelector('vc-scroll').update()">
                    <vc-searchbar id="menuProperties" class="vc-doc-api-menuSearchBar">
                        <vc-text placeholder="Search" type="search" name="name" value="" onkeyup="document.querySelector('#menuProperties').search(document.querySelector('#menuProperties'));"></vc-text>
                        <!-- <input type="text" name="name" value="" onkeyup="document.querySelector('#menuProperties').search(document.querySelector('#menuProperties'));"
                            placeholder="Search"> -->
                    </vc-searchbar>
                    <div id="menuPropertiesContainer"></div>
                </vc-item>

                <vc-item type="dropdown" name="Functions" class="vc-doc-api-menuDropdown" onclick="this.querySelector('vc-scroll').update()">
                    <vc-searchbar id="menuFunctions" class="vc-doc-api-menuSearchBar" thickness="8">
                        <vc-text placeholder="Search" type="search" name="name" value="" onkeyup="document.querySelector('#menuFunctions').search(document.querySelector('#menuFunctions'));"></vc-text>
                        <!-- <input type="text" name="name" value="" onkeyup="document.querySelector('#menuFunctions').search(document.querySelector('#menuFunctions'));"
                            placeholder="Search"> -->
                    </vc-searchbar>
                    <div id="menuFunctionsContainer">
                    </div>
                </vc-item>
                <vc-item id="vc-doc-api-togglePrivate" name="Private" icon="visibility" icon-position="right" onclick="document.querySelector('vc-doc-api').togglePrivate(this);"></vc-item>
            </vc-menu>

        </vc-layout>
        <div class="vc-doc-colorBand"></div>
        <vc-scroll thickness="8">
            <div id="vc-doc-api-content">
                <div id="vc-doc-api-header">
                </div>
                <div>
                    <div class="vc-doc-api-block">
                        <div class="vc-doc-api-t2">
                            Properties
                        </div>
                        <div id="noPublicProp" class="notFound vc-doc-api-noExist">None</div>
                        <vc-doc-table id="publicPropTable" class="vc-doc-api-noExist" columntitle="Property, Type, Description" columnwidth="200px ,200px ,calc(100% - 400px)"></vc-doc-table>
                    </div>

                    <div class="vc-doc-api-block private">
                        <div class="vc-doc-api-t2">
                            Private properties
                        </div>
                        <div id="noPrivateProp" class="notFound vc-doc-api-noExist">None</div>
                        <vc-doc-table id="privatePropTable" class="vc-doc-api-noExist" columntitle="Property, Type, Description" columnwidth="200px ,200px ,calc(100% - 400px)"></vc-doc-table>
                    </div>

                    <div class="vc-doc-api-block">
                        <div class="vc-doc-api-t2">
                            Functions
                        </div>
                        <div id="noPublicFuncSumm" class="notFound vc-doc-api-noExist">None</div>
                        <vc-doc-table id="publicFuncSummTable" class="vc-doc-api-noExist" columntitle="Function, Return, Description" columnwidth="200px ,200px ,calc(100% - 400px)"></vc-doc-table>
                        <div id="publicFunctionDetails"></div>
                    </div>
                    <div class="vc-doc-api-block private">
                        <div class="vc-doc-api-t2">
                            Private functions
                        </div>
                        <div id="noPrivateFuncSumm" class="notFound vc-doc-api-noExist">None</div>
                        <vc-doc-table id="privateFuncSummTable" class="vc-doc-api-noExist" columntitle="Function, Return, Description" columnwidth="200px ,200px ,calc(100% - 400px)"></vc-doc-table>
                        <div id="privateFunctionDetails"></div>
                    </div>


                </div>
            </div>
        </vc-scroll>
        <button id="vc-doc-api-goToTop" onclick="document.querySelector('vc-doc-api').goToTop();">
            <i class="material-icons">arrow_upward</i>
        </button>
    </vc-layout>
</template>

<script>
    vcomet.element("vc-doc-api", null, {

        data: {
            name: "Jesus",
            age: 35
        },

        properties: {},

        privateProperties: {
            misc: {
                value: {}
            }
        },

        functions: {
            // @function setData (public) [Set up document] @param data @param config
            setData(data, config) {
                this._setupData(data, config);
            },
            // @function togglePrivate (public) [Toggle private api] @param el [Toggle button]
            togglePrivate(el) { // Hide show private data
                var privateElements = document.querySelectorAll(".private");

                privateElements.forEach(function (privateElement) {
                    privateElement.classList.toggle("vc-doc-api-hidePrivate");
                });
                if (el) {
                    var icon = el.querySelector("i");

                    if (icon.textContent === "visibility") {
                        icon.textContent = "î£µ";
                    } else {
                        icon.textContent = "visibility";
                    }
                }
                var tables = document.querySelectorAll("vc-doc-table");
                if (tables) {
                    tables.forEach(function (table) {
                        table.onReady(function () {
                            table.adjustRowHeight();
                        });
                    });
                }
            },
            // @function goTo (public) [Scroll to id position] @param element @param id
            goTo(element, id) {
                // Hide menu when clicked on an item
                var parentDropdown = element.parentNode;
                while (parentDropdown.getAttribute("type") != "dropdown") { // TODO Update with vcomet getParent
                    parentDropdown = parentDropdown.parentNode;
                }
                parentDropdown.setAttribute("data-visible", false);

                this._misc.scroll.scrollTo(0);
                this._misc.scroll.scrollTo(document.querySelector("#" + id).getBoundingClientRect()
                    .top - 105, null, 0.2);
            },
            // @function goToFunction (public) [Scroll to id function position] @param id
            goToFunction(id) {
                this._misc.scroll.scrollTo(0);
                this._misc.scroll.scrollTo(document.querySelector("#" + id).getBoundingClientRect()
                    .top - 105, null, 0.2);
            },
            // @function goToTop (public) [Scroll to top]
            goToTop() { // Scroll to top
                this._misc.scroll.scrollTo(0, null, 0.05);
            }
        },

        privateFunctions: {
            // @function init (private) [Initialize api]
            init: function () {
                var el = this;
                var scroll = this.querySelector("vc-scroll");
                scroll.onScrolled(function () {
                    el._scrollFunction();
                });
                this._misc.scroll = scroll;
                this._misc.apiContent = document.querySelector("#vc-doc-api-content");
                this._misc.goToTop = document.querySelector("#vc-doc-api-goToTop");
            },
            // @function hidePrivate (private) [Force to hide private data]
            hidePrivate: function () {
                var privateElements = document.querySelectorAll(".private");
                privateElements.forEach(function (privateElement) {
                    privateElement.classList.add("vc-doc-api-hidePrivate");
                });
                document.querySelector("#vc-doc-api-togglePrivate").querySelector("i").textContent =
                    "visibility";
            },
            // @function createDiv (private) {html object} @param options
            createDiv: function (options) {
                var currentDiv = document.createElement("div");
                if (options.class) {
                    if (Array.isArray(options.class)) {
                        options.class.forEach(function (cc) {
                            currentDiv.classList.add(cc);
                        });
                    } else {
                        currentDiv.classList.add(options.class);
                    }
                }
                if (options.content) {
                    currentDiv.appendChild(options.content);
                }
                if (options.innerText) {
                    currentDiv.innerText = options.innerText;
                }
                if (options.id) {
                    currentDiv.id = options.id;
                }
                return currentDiv;
            },
            // @function scrollFunction (private) [vc-scroll onScrolled listener. Used to toggle go to top button]
            scrollFunction: function () {
                if (this._misc.scroll._misc.vertical.position < 0) {
                    this._misc.goToTop.classList.add("vc-doc-api-showGoToTop");
                    this._misc.goToTop.classList.remove("vc-doc-api-hideGoToTop");
                } else {
                    this._misc.goToTop.classList.remove("vc-doc-api-showGoToTop");
                    this._misc.goToTop.classList.add("vc-doc-api-hideGoToTop");
                }
            },
            // @function cleanData (private) [Clean data before setting up]
            cleanData: function () {
                var el = this;
                document.querySelector("#publicFuncSummTable").classList.add("vc-doc-api-noExist");
                document.querySelector("#privateFuncSummTable").classList.add("vc-doc-api-noExist");
                document.querySelector("#publicFunctionDetails").innerHTML = "";
                document.querySelector("#privateFunctionDetails").innerHTML = "";
                document.querySelector("#vc-doc-api-header").innerHTML = "";
                document.querySelector("#menuPropertiesContainer").innerHTML = "";
                document.querySelector("#menuFunctionsContainer").innerHTML = "";
                document.querySelector("#noPublicProp").classList.add("vc-doc-api-noExist");
                document.querySelector("#noPrivateProp").classList.add("vc-doc-api-noExist");
                document.querySelector("#publicPropTable").classList.add("vc-doc-api-noExist");
                document.querySelector("#privatePropTable").classList.add("vc-doc-api-noExist");
                el._hidePrivate();
                el._misc.scroll.scrollTo(0);
            },
            // @function setupData (private) [Set up document] @param data @param config
            setupData: function (data, config) {
                var el = this;

                el._cleanData();

                el._misc.parsedCount = 3; // Counter to know when all api parts are appended
                //// Internal functions
                var PRIVATE = "private";
                var __hasPublicProperties = null;
                var __hasPrivateProperties = null;
                var __hasPublicFunctions = null;
                var __hasPrivateFunctions = null;


                //@function formatType [Format type block with user instructions] @param typeStr
                function formatType(typeStr) {
                    if (typeStr) {
                        typeStr = typeStr.split("\\n").join("<br />");
                        if (config.__typeUpperCase) {
                            typeStr = typeStr.substring(0, 1).toUpperCase() + typeStr.substring(1, typeStr.length);
                        } else if (config.__typeLowerCase) {
                            typeStr = typeStr.substring(0, 1).toLowerCase() + typeStr.substring(1, typeStr.length);
                        }
                    }
                    return typeStr;
                }

                //@function hasPublicProperties [Return if current doc has public properties or not]
                function hasPublicProperties() {
                    if (__hasPublicProperties === null) {
                        __hasPublicProperties = false;
                        data.properties.forEach(function (prop) {
                            if (!prop.scope || prop.scope != PRIVATE) {
                                __hasPublicProperties = true;
                            }
                        });
                    }
                    return __hasPublicProperties;
                }

                //@function getPublicProperties [Return json with public properties]
                function getPublicProperties() {
                    var publicProperties = [];
                    if (hasPublicProperties()) {
                        data.properties.forEach(function (prop) {
                            if (!prop.scope || prop.scope != PRIVATE) {
                                var currentPublicP = {};
                                currentPublicP.data = [];
                                currentPublicP.id = "proppub" + prop.name;
                                currentPublicP.data.push({
                                    value: prop.name
                                });
                                currentPublicP.data.push({
                                    value: formatType(prop.type)
                                });
                                currentPublicP.data.push({
                                    value: formatDescription(prop.description)
                                });
                                publicProperties.push(currentPublicP);
                            }
                        });
                    }
                    return publicProperties;
                }

                //@function hasPrivateProperties [Return if current doc has private properties or not]
                function hasPrivateProperties() {
                    if (__hasPrivateProperties === null) {
                        __hasPrivateProperties = false;
                        data.properties.forEach(function (prop) {
                            if (prop.scope && prop.scope === PRIVATE) {
                                __hasPrivateProperties = true;
                            }
                        });
                    }
                    return __hasPrivateProperties;
                }

                //@function getPrivateProperties [Return json with private properties]
                function getPrivateProperties() {
                    var privateProperties = [];
                    if (hasPrivateProperties()) {
                        data.properties.forEach(function (prop) {
                            if (prop.scope && prop.scope === PRIVATE) {
                                var currentPrivateP = {};
                                currentPrivateP.data = [];
                                currentPrivateP.id = "proppri" + prop.name;
                                currentPrivateP.data.push({
                                    value: prop.name
                                });
                                currentPrivateP.data.push({
                                    value: formatType(prop.type)
                                });
                                currentPrivateP.data.push({
                                    value: formatDescription(prop.description)
                                });
                                privateProperties.push(currentPrivateP);
                            }
                        });
                    }
                    return privateProperties;
                }

                //@function hasPublicFunctions [Return if current doc has public functions or not]
                function hasPublicFunctions() {
                    if (__hasPublicFunctions === null) {
                        __hasPublicFunctions = false;
                        data.methods.forEach(function (method) {
                            if (!method.scope || method.scope != PRIVATE) {
                                __hasPublicFunctions = true;
                            }
                        });
                    }
                    return __hasPublicFunctions;
                }

                //@function hasPrivateFunctions [Return if current doc has private functions or not]
                function hasPrivateFunctions() {
                    if (__hasPrivateFunctions === null) {
                        __hasPrivateFunctions = false;
                        data.methods.forEach(function (method) {
                            if (method.scope && method.scope === PRIVATE) {
                                __hasPrivateFunctions = true;
                            }
                        });
                    }
                    return __hasPrivateFunctions;
                }

                // @function getPublicFunctionsSummary [Return json with public functions summary]
                function getPublicFunctionsSummary() {
                    var publicFunctionsSummary = [];
                    if (hasPublicFunctions()) {
                        data.methods.forEach(function (method) {
                            if (!method.scope || method.scope != PRIVATE) {
                                var currentPublicFSummary = {};
                                currentPublicFSummary.data = [];
                                currentPublicFSummary.data.push({
                                    value: method.name,
                                    onclick: "this.parentNode.parentNode.parentNode.parentcomponent.goToFunction('funcpub" +
                                        method.name + "');",
                                    color: "#5264c3"
                                });
                                if (method.return) {
                                    currentPublicFSummary.data.push({
                                        value: formatType(method.return.type)
                                    });
                                } else if (config.__voidControl) {
                                    currentPublicFSummary.data.push({
                                        value: "Void"
                                    });
                                } else {
                                    currentPublicFSummary.data.push({
                                        value: ""
                                    });
                                }
                                currentPublicFSummary.data.push({
                                    value: formatDescription(method.description)
                                });
                                publicFunctionsSummary.push(currentPublicFSummary);
                            }
                        });
                    }
                    return publicFunctionsSummary;
                }

                // @function getPrivateFunctionsSummary [Return json with private functions summary]
                function getPrivateFunctionsSummary() {
                    var privateFunctionsSummary = [];
                    if (hasPrivateFunctions()) {
                        data.methods.forEach(function (method) {
                            if (method.scope && method.scope === PRIVATE) {
                                var currentPrivateFSummary = {};
                                currentPrivateFSummary.data = [];
                                currentPrivateFSummary.data.push({
                                    value: method.name,
                                    onclick: "this.parentNode.parentNode.parentNode.parentcomponent.goToFunction('funcpri" +
                                        method.name + "');",
                                    color: "blue"
                                });
                                if (method.return) {
                                    currentPrivateFSummary.data.push({
                                        value: formatType(method.return.type)
                                    });
                                } else if (config.__voidControl) {
                                    currentPrivateFSummary.data.push({
                                        value: "Void"
                                    });
                                } else {
                                    currentPrivateFSummary.data.push({
                                        value: ""
                                    });
                                }
                                currentPrivateFSummary.data.push({
                                    value: formatDescription(method.description)
                                });
                                privateFunctionsSummary.push(currentPrivateFSummary);
                            }
                        });
                    }
                    return privateFunctionsSummary;
                }

                //@function printPublicFuntions [Returns public functions details as html string]
                function printPublicFuntions() {
                    var publicFunctionsDiv = document.querySelector("#publicFunctionDetails");
                    if (hasPublicFunctions()) {
                        data.methods.forEach(function (method) {
                            if (!method.scope || method.scope != PRIVATE) {
                                publicFunctionsDiv.appendChild(printFunction(method));
                            }
                        });
                    }
                }

                //@function printPrivateFuntions [Returns private functions details as html string]
                function printPrivateFuntions() {
                    var privateFunctionsDiv = document.querySelector("#privateFunctionDetails");
                    if (hasPrivateFunctions()) {
                        data.methods.forEach(function (method) {
                            if (method.scope && method.scope === PRIVATE) {
                                privateFunctionsDiv.appendChild(printFunction(method, true));
                            }
                        });
                    }
                }

                // @function printFunction [Return function data as html string]
                function printFunction(method, isPrivate) {
                    var fragment = document.createDocumentFragment();
                    var result = el._createDiv({
                        class: "vc-doc-api-functionDetail"
                    });
                    var details = el._createDiv({
                        class: "vc-doc-api-t3",
                        innerText: "Details"
                    });
                    result.appendChild(details);
                    var methodId = "";
                    if (isPrivate) {
                        methodId = "funcpri" + method.name;
                    } else {
                        methodId = "funcpub" + method.name;
                    }
                    var fName = el._createDiv({
                        class: ["vc-doc-api-t3", "vc-doc-api-textColorFunction"],
                        id: methodId
                    });
                    var sName = document.createElement("span");
                    sName.innerText = method.name + "(";
                    fName.appendChild(sName);
                    if (method.params.length > 0) {
                        for (var methodParamI = 0; methodParamI < method.params.length; methodParamI++) {
                            var currentParam = document.createElement("span");
                            currentParam.classList.add("vc-doc-api-textColorName");
                            currentParam.innerText = method.params[methodParamI].name;
                            if (method.params[methodParamI].optional) {
                                currentParam.innerText += '*';
                            }
                            if (methodParamI < (method.params.length - 1)) {
                                currentParam.innerText += ', ';
                            }
                            fName.appendChild(currentParam);
                        }
                    }
                    var sClose = document.createElement("span");
                    sClose.innerText = ")";
                    fName.appendChild(sClose);
                    result.appendChild(fName);
                    if (method.description) {
                        var desc = el._createDiv({
                            innerText: formatDescription(method.description)
                        }); // TODO Format description as innertext, better append
                        result.appendChild(desc);
                    }
                    if (method.params.length > 0) {
                        var table = document.createElement("vc-doc-table");
                        table.columntitle = "Parameter, Type, Description";
                        table.columnwidth = "200px ,200px ,calc(100% - 400px)";
                        var params = getParams(method);
                        params.forEach(function (param) {
                            var row = document.createElement("vc-row");
                            param.forEach(function (paramCell) {
                                var cell = document.createElement("vc-cell");
                                cell.innerText = paramCell;
                                row.appendChild(cell);
                            });
                            table.appendChild(row);
                        });
                        result.appendChild(table);
                    }
                    if (method.return) {
                        el._misc.parsedCount++; // TODO wait for each function return slows down api loading. It could be load after shown if boost needed
                        var table = document.createElement("vc-doc-table");
                        table.ondrawn(function () {                            
                            setTimeout(function () {
                                if (document.querySelector('vc-doc-api')) {
                                    document.querySelector('vc-doc-api')._onDrawn();
                                }
                            }, 0);
                        });
                        table.columntitle = "Return, Description";
                        table.columnwidth = "200px ,calc(100% - 200px)";
                        var methodReturn = getReturn(method);
                        var row = document.createElement("vc-row");
                        methodReturn.forEach(function (paramReturn) {
                            var cell = document.createElement("vc-cell");
                            cell.innerText = paramReturn;
                            row.appendChild(cell);
                        });
                        table.appendChild(row);
                        result.appendChild(table);
                    } else {
                        if (config.__voidControl) {
                            el._misc.parsedCount++;// TODO wait for each function return slows down api loading. It could be load after shown if boost needed
                            var table = document.createElement("vc-doc-table");
                            table.ondrawn(function () {
                                setTimeout(function () {
                                    document.querySelector('vc-doc-api')._onDrawn();
                                }, 0);
                            });
                            table.columntitle = "Return, Description";
                            table.columnwidth = "200px ,calc(100% - 200px)";
                            var methodReturn = getReturn(method, true);
                            var row = document.createElement("vc-row");
                            methodReturn.forEach(function (paramReturn) {
                                var cell = document.createElement("vc-cell");
                                cell.innerText = paramReturn;
                                row.appendChild(cell);
                            });
                            table.appendChild(row);
                            result.appendChild(table);
                        }
                    }
                    if (method.exceptions.length > 0) {
                        el._misc.parsedCount++;// TODO wait for each function exception slows down api loading. It could be load after shown if boost needed
                        var table = document.createElement("vc-doc-table");
                        table.ondrawn(function () {
                            setTimeout(function () {
                                document.querySelector('vc-doc-api')._onDrawn();
                            }, 0);
                        });
                        table.columntitle = "Exception, Description";
                        table.columnwidth = "200px ,calc(100% - 200px)";
                        var excepts = getExceptions(method);
                        excepts.forEach(function (except) {
                            var row = document.createElement("vc-row");
                            except.forEach(function (exceptCell) {
                                var cell = document.createElement("vc-cell");
                                cell.innerText = exceptCell;
                                row.appendChild(cell);
                            });
                            table.appendChild(row);
                        });
                        result.appendChild(table);
                    }
                    return result;
                }


                // @function getParams {json} [Get function params]
                function getParams(method) {
                    var params = [];
                    method.params.forEach(function (param) {
                        var currentParam = [];
                        var pName = param.name;
                        if (param.optional) {
                            pName += " (optional)";
                        }
                        currentParam.push(pName);
                        currentParam.push(formatType(param.type) || "");
                        currentParam.push(formatDescription(param.description) || "");
                        params.push(currentParam);
                    });
                    return params;
                }

                // @function getReturn
                function getReturn(method, isVoid) {
                    var result = [];
                    if (!isVoid) {
                        result.push(formatType(method.return.type));
                        result.push(formatDescription(method.return.description) || "");
                    } else {
                        result.push("Void");
                    }
                    return result;
                }

                // @function getExceptions
                function getExceptions(method) {
                    var result = [];
                    method.exceptions.forEach(function (except) {
                        var currentException = [];
                        currentException.push(except.name);
                        currentException.push(formatDescription(except.description) || "");
                        result.push(currentException);
                    });
                    return result;
                }

                //@function formatDescription [Format description block with user instructions] @param descriptionStr
                function formatDescription(descriptionStr) {
                    if (descriptionStr) {
                        descriptionStr = descriptionStr.split("\\n").join("<br />");
                        if (config.__addDot) {
                            if (descriptionStr.charAt(descriptionStr.length - 1) != ".") {
                                descriptionStr += ".";
                            }
                        } else if (config.__removeDot) {
                            if (descriptionStr.charAt(descriptionStr.length - 1) === ".") {
                                descriptionStr.slice(-1);
                            }
                        }
                        if (config.__descriptionUpperCase) {
                            descriptionStr = descriptionStr.charAt(0).toUpperCase() + descriptionStr.slice(
                                1);
                        } else if (config.__descriptionLowerCase) {
                            descriptionStr = descriptionStr.charAt(0).toLowerCase() + descriptionStr.slice(
                                1);
                        }
                    }
                    return descriptionStr;
                }

                this.data.fileName = data.path.replace(/^.*[\\\/]/, '');
                this.data.header = data.header;
                this.data.band = config.__band;

                var header = document.createDocumentFragment();
                var fileName = document.createElement("div");
                fileName.classList.add("vc-doc-api-t1");
                fileName.innerText = this.data.fileName;
                header.appendChild(fileName);
                var headerText = document.createElement("p");
                this.data.header.forEach(function (cHeader) {
                    headerText.innerText += cHeader + "<br>";
                });
                header.appendChild(headerText);
                document.querySelector("#vc-doc-api-header").appendChild(header);

                setTimeout(function () {
                    document.querySelector('vc-doc-api')._onDrawn();
                }, 0);



                // Set public properties
                if (hasPublicProperties()) {
                    var publicPropertyTable = document.querySelector("#publicPropTable");
                    publicPropertyTable.cleanTable();
                    publicPropertyTable.classList.remove("vc-doc-api-noExist");
                    var publicProperties = getPublicProperties();
                    publicProperties.forEach(function (pp) {
                        publicPropertyTable.addRow(pp);
                    });
                } else {
                    document.querySelector("#noPublicProp").classList.remove("vc-doc-api-noExist");
                }
                // Set private properties
                if (hasPrivateProperties()) {
                    var privatePropertyTable = document.querySelector("#privatePropTable");
                    privatePropertyTable.cleanTable();
                    privatePropertyTable.classList.remove("vc-doc-api-noExist");
                    var privateProperties = getPrivateProperties();
                    privateProperties.forEach(function (pp) {
                        privatePropertyTable.addRow(pp);
                    });
                } else {
                    document.querySelector("#noPrivateProp").classList.remove("vc-doc-api-noExist");
                }


                // Set public functions summary
                if (hasPublicFunctions()) {
                    var publicFunctionTable = document.querySelector("#publicFuncSummTable");
                    publicFunctionTable.parentcomponent = el;
                    publicFunctionTable.cleanTable();
                    publicFunctionTable.classList.remove("vc-doc-api-noExist");
                    var publicFunctions = getPublicFunctionsSummary();
                    publicFunctions.forEach(function (pp) {
                        publicFunctionTable.addRow(pp);
                    });
                } else {
                    document.querySelector("#noPublicFuncSumm").classList.remove("vc-doc-api-noExist");
                }

                // Set private functions summary
                if (hasPrivateFunctions()) {
                    var privateFunctionTable = document.querySelector("#privateFuncSummTable");
                    privateFunctionTable.parentcomponent = el;
                    privateFunctionTable.cleanTable();
                    privateFunctionTable.classList.remove("vc-doc-api-noExist");
                    var privateFunctions = getPrivateFunctionsSummary();
                    privateFunctions.forEach(function (pp) {
                        privateFunctionTable.addRow(pp);
                    });
                } else {
                    document.querySelector("#noPrivateFuncSumm").classList.remove("vc-doc-api-noExist");
                }

                // Set properties menu
                var propertiesMenuContainer = document.querySelector("#menuPropertiesContainer");
                var propertiesMenuScroll = document.createElement("vc-scroll");
                propertiesMenuScroll.thickness = 8;
                var hasMenuPublicProp = false;
                data.properties.forEach(function (prop) {
                    var propItem = document.createElement("vc-item");
                    propItem.classList.add("vc-doc-api-menuSearchItem");
                    if (prop.scope && prop.scope.toLowerCase() === PRIVATE) {
                        propItem.classList.add("private", "vc-doc-api-hidePrivate");
                        propItem.setAttribute("onclick",
                            'document.querySelector("vc-doc-api").goTo(this, "proppri' + prop.name +
                            '");');
                    } else {
                        propItem.setAttribute("onclick",
                            'document.querySelector("vc-doc-api").goTo(this, "proppub' + prop.name +
                            '");');
                        hasMenuPublicProp = true;
                    }
                    propItem.setAttribute("name", prop.name);
                    propItem.setAttribute("value", prop.name);
                    propItem.innerText = prop.name;
                    propertiesMenuScroll.appendChild(propItem);
                });
                if (!hasMenuPublicProp) {
                    var propItem = document.createElement("vc-item");
                    propItem.setAttribute("name", "None");
                    propItem.setAttribute("value", "None");
                    propItem.innerText = "None";
                    propItem.classList.add("vc-doc-api-menuSearchItem");
                    propertiesMenuScroll.appendChild(propItem);
                }
                propertiesMenuContainer.appendChild(propertiesMenuScroll);

                setTimeout(function () {
                    document.querySelector('vc-doc-api')._onDrawn();
                }, 0);
                // Set functions menu
                var functionsMenuContainer = document.querySelector("#menuFunctionsContainer");
                var functionsMenuScroll = document.createElement("vc-scroll");
                functionsMenuScroll.thickness = 8;
                data.methods.forEach(function (method) {
                    var funcItem = document.createElement("vc-item");
                    funcItem.classList.add("vc-doc-api-menuSearchItem");
                    if (method.scope && method.scope.toLowerCase() === PRIVATE) {
                        funcItem.classList.add("private", "vc-doc-api-hidePrivate");
                        funcItem.setAttribute("onclick",
                            'document.querySelector("vc-doc-api").goTo(this, "funcpri' + method
                            .name +
                            '");');
                    } else {
                        funcItem.setAttribute("onclick",
                            'document.querySelector("vc-doc-api").goTo(this, "funcpub' + method
                            .name +
                            '");');
                    }
                    funcItem.setAttribute("name", method.name);
                    funcItem.setAttribute("value", method.name);
                    funcItem.innerText = method.name;
                    functionsMenuScroll.appendChild(funcItem);
                });
                functionsMenuContainer.appendChild(functionsMenuScroll);
                setTimeout(function () {
                    document.querySelector('vc-doc-api')._onDrawn();
                }, 0);


                // Print function details
                printPublicFuntions();
                printPrivateFuntions();

            },
            // @function onDrawn (private) [Called when api is parsed and shown on screen]
            onDrawn: function () {
                var el = this;
                el._misc.parsedCount--;
                if (el._misc.parsedCount <= 0) {
                    vcomet.triggerCallback("ondrawn", el, el, [el]);
                    var scrolls = document.querySelector("vc-doc-api").querySelectorAll("vc-scroll");
                    scrolls.forEach(function (scr) {
                        scr.update();
                    });
                }
            }
        },

        onWindowResize: function (event) {},


        onCreated: function () {
            vcomet.createCallback("ondrawn", this);
        },

        onBubbleRender: function () {
            var el = this;
            el._init();
            el.togglePrivate(); // Hide private properties and functions at the beggining
            // Initialize menu search bars
            document.querySelector("#menuProperties").onSearch(function (filters) {
                var name = filters.name;
                var toFilterChilds = document.querySelector("#menuPropertiesContainer").querySelector(
                    ".vc-scroll-content").children;

                for (var i = 0; i < toFilterChilds.length; i++) {
                    if (toFilterChilds[i].classList.contains("vc-doc-api-menuSearchItem") &&
                        toFilterChilds[i].classList.contains("vc-doc-api-menuSearchItem") &&
                        toFilterChilds[i].getAttribute("value").toLowerCase().indexOf(name.toLowerCase()) >
                        -1) {
                        toFilterChilds[i].classList.remove("vc-doc-api-searchHide");
                    } else if (toFilterChilds[i].classList.contains("vc-doc-api-menuSearchItem")) {
                        toFilterChilds[i].classList.add("vc-doc-api-searchHide");
                    }
                }
            });
            document.querySelector("#menuFunctions").onSearch(function (filters) {
                var name = filters.name;
                var toFilterChilds = document.querySelector("#menuFunctionsContainer").querySelector(
                    ".vc-scroll-content").children;

                for (var i = 0; i < toFilterChilds.length; i++) {
                    if (toFilterChilds[i].classList.contains("vc-doc-api-menuSearchItem") &&
                        toFilterChilds[i].getAttribute("value").toLowerCase().indexOf(name.toLowerCase()) >
                        -1) {
                        toFilterChilds[i].classList.remove("vc-doc-api-searchHide");
                    } else if (toFilterChilds[i].classList.contains("vc-doc-api-menuSearchItem")) {
                        toFilterChilds[i].classList.add("vc-doc-api-searchHide");
                    }
                }
            });
        },

        onReady: function () {}


    });
</script>